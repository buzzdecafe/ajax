var flapjax=function(){"use strict";function n(n,t){this.fork=n,this.cleanup=t||function(){}}function t(n,t){var r=t||i;return new u(function(t,e){var u=new XMLHttpRequest;u.open(n.method,n.url,!0),u.withCredentials=!!n.withCredentials,u=o(n.headers,u),u.addEventListener("readystatechange",function(n){return function r(){n.readyState===n.DONE&&(n.removeEventListener("readystatechange",r,!1),n.status>=200&&n.status<300?e(n):t(n))}}(u),!1),u=r(u),u.send()})}var r="undefined"!=typeof setImmediate?setImmediate:"undefined"!=typeof process?process.nextTick:setTimeout,e=n;n.prototype.of=function(t){return new n(function(n,r){return r(t)})},n.of=n.prototype.of,n.prototype.rejected=function(t){return new n(function(n){return n(t)})},n.rejected=n.prototype.rejected,n.prototype.map=function(t){var r=this.fork,e=this.cleanup;return new n(function(n,e){return r(function(t){return n(t)},function(n){return e(t(n))})},e)},n.prototype.chain=function(t){var r=this.fork,e=this.cleanup;return new n(function(n,e){return r(function(t){return n(t)},function(r){return t(r).fork(n,e)})},e)},n.prototype.ap=function(t){function e(n){i(n[0]),c(n[1])}var u=this.fork,o=t.fork,i=this.cleanup,c=t.cleanup;return new n(function(n,t){function i(n){return function(u){if(!d)return n(u),s&&h?(r(function(){e(a)}),t(f(p))):u}}function c(t){if(!d)return d=!0,n(t)}var f,p,a,s=!1,h=!1,d=!1,y=u(c,i(function(n){s=!0,f=n})),l=o(c,i(function(n){h=!0,p=n}));return a=[y,l]},e)},n.prototype.concat=function(t){function e(n){i(n[0]),c(n[1])}var u=this.fork,o=t.fork,i=this.cleanup,c=t.cleanup;return new n(function(n,t){function i(n){return function(t){if(!f)return f=!0,r(function(){e(c)}),n(t)}}var c,f=!1,p=u(i(n),i(t)),a=o(i(n),i(t));return c=[p,a]},e)},n.empty=function(){return new n(function(){})},n.prototype.empty=n.empty,n.prototype.toString=function(){return"Task"},n.prototype.orElse=function(t){var r=this.fork,e=this.cleanup;return new n(function(n,e){return r(function(r){return t(r).fork(n,e)},function(n){return e(n)})},e)},n.prototype.fold=function(t,r){var e=this.fork,u=this.cleanup;return new n(function(n,u){return e(function(n){return u(t(n))},function(n){return u(r(n))})},u)},n.prototype.cata=function(n){return this.fold(n.Rejected,n.Resolved)},n.prototype.swap=function(){var t=this.fork,r=this.cleanup;return new n(function(n,r){return t(function(n){return r(n)},function(t){return n(t)})},r)},n.prototype.bimap=function(t,r){var e=this.fork,u=this.cleanup;return new n(function(n,u){return e(function(r){return n(t(r))},function(n){return u(r(n))})},u)},n.prototype.rejectedMap=function(t){var r=this.fork,e=this.cleanup;return new n(function(n,e){return r(function(r){return n(t(r))},function(n){return e(n)})},e)};var u=e,o=function(n,t){return Object.keys(n).forEach(function(r){t.setRequestHeader(r,n[r])}),t},i=function(n){return n};return t}();
